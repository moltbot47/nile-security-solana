{
  "version": "1.0.0",
  "description": "Known Solana exploit patterns for NILE Likeness scoring dimension",
  "patterns": [
    {
      "id": "SOL-001",
      "name": "Wormhole Bridge Exploit",
      "date": "2022-02-02",
      "loss_usd": 320000000,
      "category": "signature_verification",
      "description": "Missing verification of guardian signatures allowed attacker to forge VAA messages and mint 120,000 wETH",
      "indicators": [
        "Missing signer validation on bridge message verification",
        "Deprecated secp256k1 verification (solana_program::secp256k1_recover)",
        "Unchecked guardian set changes"
      ],
      "severity": "critical",
      "cwe": "CWE-347"
    },
    {
      "id": "SOL-002",
      "name": "Mango Markets Exploit",
      "date": "2022-10-11",
      "loss_usd": 114000000,
      "category": "oracle_manipulation",
      "description": "Price oracle manipulation via thin-liquidity perp market allowed attacker to inflate collateral value and drain lending pool",
      "indicators": [
        "Single oracle source dependency",
        "No TWAP or median oracle aggregation",
        "Perp market price used as spot oracle",
        "No circuit breaker on extreme price moves"
      ],
      "severity": "critical",
      "cwe": "CWE-20"
    },
    {
      "id": "SOL-003",
      "name": "Cashio Dollar Exploit",
      "date": "2022-03-23",
      "loss_usd": 52000000,
      "category": "account_validation",
      "description": "Missing account validation in mint function allowed attacker to pass fake collateral accounts and mint unlimited CASH stablecoin",
      "indicators": [
        "Missing owner check on collateral account",
        "Unchecked account data deserialization",
        "No validation of PDA seeds against expected program"
      ],
      "severity": "critical",
      "cwe": "CWE-287"
    },
    {
      "id": "SOL-004",
      "name": "Crema Finance Exploit",
      "date": "2022-07-03",
      "loss_usd": 8780000,
      "category": "flash_loan_reentrancy",
      "description": "Flash loan + price manipulation in concentrated liquidity pool allowed attacker to drain LP funds via fake tick account",
      "indicators": [
        "Unchecked tick account ownership",
        "Flash loan callback without state validation",
        "Missing slippage protection on LP operations"
      ],
      "severity": "critical",
      "cwe": "CWE-841"
    },
    {
      "id": "SOL-005",
      "name": "Slope Wallet Key Theft",
      "date": "2022-08-03",
      "loss_usd": 4100000,
      "category": "key_management",
      "description": "Wallet logged seed phrases in plaintext to centralized Sentry server, enabling mass key theft",
      "indicators": [
        "Plaintext secret storage",
        "External logging of sensitive data",
        "Centralized key custody without encryption"
      ],
      "severity": "critical",
      "cwe": "CWE-312"
    },
    {
      "id": "SOL-006",
      "name": "Generic Rug Pull Pattern",
      "date": "ongoing",
      "loss_usd": 0,
      "category": "rug_pull",
      "description": "Common pattern: deploy token with active mint authority + freeze authority, pump via social media, drain liquidity",
      "indicators": [
        "Mint authority not revoked",
        "Freeze authority active",
        "Program deployed < 7 days ago",
        "Single wallet holds > 80% of supply",
        "No audit, no verified source",
        "Upgrade authority active (single signer)"
      ],
      "severity": "critical",
      "cwe": "CWE-284"
    },
    {
      "id": "SOL-007",
      "name": "PDA Seed Collision",
      "date": "ongoing",
      "category": "pda_collision",
      "description": "Using insufficient or predictable PDA seeds allows attacker to derive the same PDA for different logical entities",
      "indicators": [
        "PDA derived from single user-controlled seed",
        "Missing discriminator in PDA seeds",
        "Reuse of PDA across different instruction contexts"
      ],
      "severity": "high",
      "cwe": "CWE-330"
    },
    {
      "id": "SOL-008",
      "name": "Missing Signer Check",
      "date": "ongoing",
      "category": "access_control",
      "description": "Instruction handler does not verify that required accounts are signers, allowing unauthorized execution",
      "indicators": [
        "Account constraint missing 'signer' or 'has_one'",
        "Authority account not checked against expected PDA",
        "Missing #[account(signer)] in Anchor"
      ],
      "severity": "critical",
      "cwe": "CWE-862"
    },
    {
      "id": "SOL-009",
      "name": "Unchecked Arithmetic Overflow",
      "date": "ongoing",
      "category": "arithmetic",
      "description": "Integer arithmetic without overflow checks can lead to wrapping behavior, enabling token minting or fund drainage",
      "indicators": [
        "Use of wrapping_add/wrapping_mul in token calculations",
        "Missing checked_add/checked_sub on balance operations",
        "Casting between u64 and u128 without bounds checking"
      ],
      "severity": "high",
      "cwe": "CWE-190"
    },
    {
      "id": "SOL-010",
      "name": "Unsafe CPI Invocation",
      "date": "ongoing",
      "category": "cross_program",
      "description": "Cross-Program Invocation without proper program ID validation allows attacker to substitute a malicious program",
      "indicators": [
        "CPI target program ID not validated against constant",
        "invoke() used instead of invoke_signed() for PDA authority",
        "Missing program constraint in Anchor (#[account(constraint = ...)])"
      ],
      "severity": "high",
      "cwe": "CWE-346"
    }
  ]
}
